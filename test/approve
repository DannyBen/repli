#!/usr/bin/env bash
# Run this from the root directory

cd ./test || exit
source approvals.bash

export REPLICATE_HOST=http://localhost:3000
export REPLICATE_API_TOKEN=no-token-needed

if [ "$(curl -s ${REPLICATE_HOST}/ | jq -r '."mock server status"')" != "running" ]; then
  echo "Mock server NOT running - aborting"
  exit 1
fi

describe "help"
  approve "repli"
  allow_diff "\/home\/[^\/]*"
  approve "repli --help"

describe "info"
  approve "repli info"
  approve "repli info google/nano-banana"
  approve "repli info google/nano-banana --json"
